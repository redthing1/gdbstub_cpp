#!/bin/bash
# GDB Stub Test Runner - Clean CLI

set -e
cd "$(dirname "$0")"

echo "🔧 GDB Stub Test Runner"
echo "======================"

# Check if we need to build
if [[ ! -f "tests/build/test_helper" ]]; then
    echo "Building test helper..."
    cd tests/build
    cmake .. && make
    cd ../..
fi

# Run tests
echo "Running test suite..."
echo ""
python3 tests/test.py
result=$?

echo ""
if [[ $result -eq 0 ]]; then
    echo "✅ All tests passed"
else
    echo "❌ Some tests failed"
fi

exit $result